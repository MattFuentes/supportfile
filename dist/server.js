(()=>{"use strict";var t={64:function(t,e,i){var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var o=Object.getOwnPropertyDescriptor(e,i);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,o)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),o=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||n(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),e.nonce=void 0,e.nonce={},o(i(906),e),o(i(580),e)},580:function(t,e,i){var n=this&&this.__decorate||function(t,e,i,n){var o,a=arguments.length,r=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(r=(a<3?o(r):a>3?o(e,i,r):o(e,i))||r);return a>3&&r&&Object.defineProperty(e,i,r),r},o=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(o,a){function r(t){try{c(n.next(t))}catch(t){a(t)}}function s(t){try{c(n.throw(t))}catch(t){a(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(r,s)}c((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.QaMattMessageExtensionBot=void 0;const a=i(698),r=i(974),s=i(58),c=i(194),l=i(444),d=i(393),u=i(346);r("msteams");let p=class extends c.DialogBot{constructor(t,e){super(t,e,new l.MainDialog),this._qaMattMessageExtension=new u.default,this.onMembersAdded(((t,e)=>o(this,void 0,void 0,(function*(){const i=t.activity.membersAdded;if(i&&i.length>0)for(let e=0;e<i.length;e++)i[e].id!==t.activity.recipient.id&&(yield this.sendWelcomeCard(t));yield e()}))))}sendWelcomeCard(t){return o(this,void 0,void 0,(function*(){const e=s.CardFactory.adaptiveCard(d.default);yield t.sendActivity({attachments:[e]})}))}};n([(0,a.MessageExtensionDeclaration)("qaMattMessageExtension")],p.prototype,"_qaMattMessageExtension",void 0),p=n([(0,a.BotDeclaration)("/api/messages",new s.MemoryStorage,process.env.MICROSOFT_APP_ID,process.env.MICROSOFT_APP_PASSWORD),(0,a.PreventIframe)("/qaMattMessageExtensionBot/aboutQaMatt.html")],p),e.QaMattMessageExtensionBot=p},393:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0});const n=i(99);e.default=n},194:function(t,e,i){var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(o,a){function r(t){try{c(n.next(t))}catch(t){a(t)}}function s(t){try{c(n.throw(t))}catch(t){a(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(r,s)}c((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.DialogBot=void 0;const o=i(58);class a extends o.TeamsActivityHandler{constructor(t,e,i){super(),this.conversationState=t,this.userState=e,this.dialog=i,this.conversationState=t,this.userState=e,this.dialog=i,this.dialogState=this.conversationState.createProperty("DialogState"),this.onMessage(((t,e)=>n(this,void 0,void 0,(function*(){yield this.dialog.run(t,this.dialogState),yield e()}))))}run(t){const e=Object.create(null,{run:{get:()=>super.run}});return n(this,void 0,void 0,(function*(){yield e.run.call(this,t),yield this.conversationState.saveChanges(t,!1),yield this.userState.saveChanges(t,!1)}))}}e.DialogBot=a},913:function(t,e,i){var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(o,a){function r(t){try{c(n.next(t))}catch(t){a(t)}}function s(t){try{c(n.throw(t))}catch(t){a(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(r,s)}c((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.HelpDialog=void 0;const o=i(883),a=i(58),r="helpWaterfallDialog";class s extends o.ComponentDialog{constructor(){super("helpDialog"),this.addDialog(new o.TextPrompt("TextPrompt")).addDialog(new o.WaterfallDialog(r,[this.introStep.bind(this)])),this.initialDialogId=r}run(t,e){return n(this,void 0,void 0,(function*(){const i=new o.DialogSet(e);i.add(this);const n=yield i.createContext(t);(yield n.continueDialog()).status===o.DialogTurnStatus.empty&&(yield n.beginDialog(this.id))}))}introStep(t){return n(this,void 0,void 0,(function*(){const e=a.MessageFactory.text("Esta sección esta en desarrollo!");return yield t.context.sendActivity(e),yield t.endDialog()}))}}e.HelpDialog=s},442:function(t,e,i){var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(o,a){function r(t){try{c(n.next(t))}catch(t){a(t)}}function s(t){try{c(n.throw(t))}catch(t){a(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(r,s)}c((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.Ivr1Example=void 0;const o=i(883),a=i(58),r="ivrWaterfallDialog";class s extends o.ComponentDialog{constructor(){super("ivr1Dialog"),this.addDialog(new o.TextPrompt("TextPrompt")).addDialog(new o.WaterfallDialog(r,[this.introStep.bind(this)])),this.initialDialogId=r}run(t,e){return n(this,void 0,void 0,(function*(){const i=new o.DialogSet(e);i.add(this);const n=yield i.createContext(t);(yield n.continueDialog()).status===o.DialogTurnStatus.empty&&(yield n.beginDialog(this.id))}))}introStep(t){return n(this,void 0,void 0,(function*(){const e=a.MessageFactory.text("Opcion 1.\nMicrosoft Teams es una plataforma unificada de comunicación y colaboración que combina chat persistente en el lugar de trabajo, reuniones de video, almacenamiento de archivos e integración de aplicaciones.");return yield t.context.sendActivity(e),yield t.endDialog()}))}}e.Ivr1Example=s},251:function(t,e,i){var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(o,a){function r(t){try{c(n.next(t))}catch(t){a(t)}}function s(t){try{c(n.throw(t))}catch(t){a(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(r,s)}c((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.Ivr2Example=void 0;const o=i(883),a=i(58),r=i(393),s="ivrWaterfallDialog";class c extends o.ComponentDialog{constructor(){super("ivr2Dialog"),this.addDialog(new o.TextPrompt("TextPrompt")).addDialog(new o.WaterfallDialog(s,[this.introStep.bind(this)])),this.initialDialogId=s}run(t,e){return n(this,void 0,void 0,(function*(){const i=new o.DialogSet(e);i.add(this);const n=yield i.createContext(t),a=yield n.continueDialog();yield this.sendWelcomeCard(t),a.status===o.DialogTurnStatus.empty&&(yield n.beginDialog(this.id))}))}sendWelcomeCard(t){return n(this,void 0,void 0,(function*(){const e=a.CardFactory.adaptiveCard(r.default);yield t.sendActivity({attachments:[e]})}))}introStep(t){return n(this,void 0,void 0,(function*(){const e=a.MessageFactory.text("Opcion 2.\nGrupo Desarrollo parte de Newtech");return yield t.context.sendActivity(e),yield t.endDialog()}))}}e.Ivr2Example=c},408:function(t,e,i){var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(o,a){function r(t){try{c(n.next(t))}catch(t){a(t)}}function s(t){try{c(n.throw(t))}catch(t){a(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(r,s)}c((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.IvrExample=void 0;const o=i(883),a=i(58),r="ivrWaterfallDialog";class s extends o.ComponentDialog{constructor(){super("ivrDialog"),this.addDialog(new o.TextPrompt("TextPrompt")).addDialog(new o.WaterfallDialog(r,[this.introStep.bind(this)])),this.initialDialogId=r}run(t,e){return n(this,void 0,void 0,(function*(){const i=new o.DialogSet(e);i.add(this);const n=yield i.createContext(t);(yield n.continueDialog()).status===o.DialogTurnStatus.empty&&(yield n.beginDialog(this.id))}))}introStep(t){return n(this,void 0,void 0,(function*(){const e=a.MessageFactory.text("Este es un ejemplo de IVR\n - 1. ¿Que es MS Teams?\n - 2. ¿I + D?");return yield t.context.sendActivity(e),yield t.endDialog()}))}}e.IvrExample=s},444:function(t,e,i){var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(o,a){function r(t){try{c(n.next(t))}catch(t){a(t)}}function s(t){try{c(n.throw(t))}catch(t){a(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(r,s)}c((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.MainDialog=void 0;const o=i(883),a=i(58),r=i(600),s=i(913),c=i(130),l=i(408),d=i(442),u=i(251),p="mainWaterfallDialog";class h extends o.ComponentDialog{constructor(){super("mainDialog"),this.addDialog(new o.TextPrompt("TextPrompt")).addDialog(new r.TeamsInfoDialog).addDialog(new s.HelpDialog).addDialog(new l.IvrExample).addDialog(new d.Ivr1Example).addDialog(new u.Ivr2Example).addDialog(new c.MentionUserDialog).addDialog(new o.WaterfallDialog(p,[this.introStep.bind(this),this.actStep.bind(this),this.finalStep.bind(this)])),this.initialDialogId=p,this.onboarding=!1}run(t,e){return n(this,void 0,void 0,(function*(){const i=new o.DialogSet(e);i.add(this);const n=yield i.createContext(t);(yield n.continueDialog()).status===o.DialogTurnStatus.empty&&(yield n.beginDialog(this.id))}))}introStep(t){return n(this,void 0,void 0,(function*(){if(t.options.restartMsg){const e=t.options.restartMsg?t.options.restartMsg:"En que te puedo ayudar?",i=a.MessageFactory.text(e,e,a.InputHints.ExpectingInput);return yield t.prompt("TextPrompt",{prompt:i})}return this.onboarding=!0,yield t.next()}))}actStep(t){return n(this,void 0,void 0,(function*(){if(t.result)switch(t.result.trim().toLocaleLowerCase()){case"who":case"who am i?":return yield t.beginDialog("teamsInfoDialog");case"ayuda":return yield t.beginDialog("helpDialog");case"ivr":return yield t.beginDialog("ivrDialog");case"1":return yield t.beginDialog("ivr1Dialog");case"2":return yield t.beginDialog("ivr2Dialog");case"menciona me":case"mencion":return yield t.beginDialog("mentionUserDialog");default:return yield t.context.sendActivity("No entendi tu pregunta, vuelve a escribirlo por favor!"),yield t.next()}else if(this.onboarding)switch(t.context.activity.text){case"who":return yield t.beginDialog("teamsInfoDialog");case"ayuda":return yield t.beginDialog("helpDialog");case"mencion":return yield t.beginDialog("mentionUserDialog");case"ivr":return yield t.beginDialog("ivrDialog");default:return yield t.context.sendActivity("No entendi tu pregunta, vuelve a escribirlo por favor!"),yield t.next()}return yield t.next()}))}finalStep(t){return n(this,void 0,void 0,(function*(){return yield t.replaceDialog(this.initialDialogId,{restartMsg:"En que te puedo ayudar?"})}))}}e.MainDialog=h},130:function(t,e,i){var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(o,a){function r(t){try{c(n.next(t))}catch(t){a(t)}}function s(t){try{c(n.throw(t))}catch(t){a(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(r,s)}c((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.MentionUserDialog=void 0;const o=i(883),a=i(58),r="mentionUserWaterfallDialog";class s extends o.ComponentDialog{constructor(){super("mentionUserDialog"),this.addDialog(new o.TextPrompt("TextPrompt")).addDialog(new o.WaterfallDialog(r,[this.introStep.bind(this)])),this.initialDialogId=r}run(t,e){return n(this,void 0,void 0,(function*(){const i=new o.DialogSet(e);i.add(this);const n=yield i.createContext(t);(yield n.continueDialog()).status===o.DialogTurnStatus.empty&&(yield n.beginDialog(this.id))}))}introStep(t){return n(this,void 0,void 0,(function*(){const e={mentioned:t.context.activity.from,text:`<at>${(new TextEncoder).encode(t.context.activity.from.name)}</at>`,type:"mention"},i=a.MessageFactory.text(`Hola de nuevo ${e.text}!`);return i.entities=[e],yield t.context.sendActivity(i),yield t.endDialog()}))}}e.MentionUserDialog=s},600:function(t,e,i){var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(o,a){function r(t){try{c(n.next(t))}catch(t){a(t)}}function s(t){try{c(n.throw(t))}catch(t){a(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(r,s)}c((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.TeamsInfoDialog=void 0;const o=i(883),a=i(58),r="teamsInfoWaterfallDialog";let s;class c extends o.ComponentDialog{constructor(){super("teamsInfoDialog"),this.addDialog(new o.TextPrompt("TextPrompt")).addDialog(new o.WaterfallDialog(r,[this.introStep.bind(this),this.actStep.bind(this),this.finalStep.bind(this)])),this.initialDialogId=r}run(t,e){return n(this,void 0,void 0,(function*(){const i=new o.DialogSet(e);i.add(this);const n=yield i.createContext(t);(yield n.continueDialog()).status===o.DialogTurnStatus.empty&&(yield n.beginDialog(this.id))}))}introStep(t){return n(this,void 0,void 0,(function*(){const e=a.MessageFactory.text("Do you want me to send you the current Teams member info?\n\nSay **yes** if you do like to see the context or **no** if you don't");return yield t.prompt("TextPrompt",{prompt:e})}))}actStep(t){return n(this,void 0,void 0,(function*(){if(t.result){if("yes"!==t.result)return yield t.context.sendActivity("Ok, maybe next time 😉"),yield t.next();s=yield a.TeamsInfo.getMember(t.context,t.context.activity.from.id),yield t.context.sendActivity(`Your name: **${s.name}**\n\nYour Teams ID: **${s.id}**\n\nYour email: **${s.email}**`)}return yield t.next()}))}finalStep(t){return n(this,void 0,void 0,(function*(){return yield t.context.sendActivity("Now it's time to add more functionality to your bot, so head over to the [docs](https://aka.ms/yoTeams) and start building"),yield t.endDialog()}))}}e.TeamsInfoDialog=c},346:function(t,e,i){var n=this&&this.__decorate||function(t,e,i,n){var o,a=arguments.length,r=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(r=(a<3?o(r):a>3?o(e,i,r):o(e,i))||r);return a>3&&r&&Object.defineProperty(e,i,r),r},o=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(o,a){function r(t){try{c(n.next(t))}catch(t){a(t)}}function s(t){try{c(n.throw(t))}catch(t){a(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(r,s)}c((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const a=i(974),r=i(698),s=i(58),c=a("msteams");let l=class{onFetchTask(t,e){return o(this,void 0,void 0,(function*(){return Promise.resolve({type:"continue",value:{title:"Input form",card:s.CardFactory.adaptiveCard({$schema:"http://adaptivecards.io/schemas/adaptive-card.json",type:"AdaptiveCard",version:"1.4",body:[{type:"TextBlock",text:"Please enter an e-mail address"},{type:"Input.Text",id:"email",placeholder:"somemail@example.com",style:"email"},{type:"ActionSet",actions:[{type:"Action.Execute",title:"OK",data:{id:"unique-id"},fallback:"Action.Submit"}]}]})}})}))}onSubmitAction(t,e){return o(this,void 0,void 0,(function*(){const t=s.CardFactory.adaptiveCard({type:"AdaptiveCard",body:[{type:"TextBlock",size:"Large",text:e.data.email},{type:"Image",url:`https://randomuser.me/api/portraits/thumb/women/${Math.round(100*Math.random())}.jpg`}],$schema:"http://adaptivecards.io/schemas/adaptive-card.json",version:"1.4"});return Promise.resolve({type:"result",attachmentLayout:"list",attachments:[t]})}))}onQuerySettingsUrl(t){return o(this,void 0,void 0,(function*(){return Promise.resolve({title:"qa-matt Message Extension Configuration",value:`https://${process.env.PUBLIC_HOSTNAME}/qaMattMessageExtension/config.html?name={loginHint}&tenant={tid}&group={groupId}&theme={theme}`})}))}onSettings(t){return o(this,void 0,void 0,(function*(){const e=t.activity.value.state;return c(`New setting: ${e}`),Promise.resolve()}))}};l=n([(0,r.PreventIframe)("/qaMattMessageExtension/config.html"),(0,r.PreventIframe)("/qaMattMessageExtension/action.html")],l),e.default=l},906:function(t,e,i){var n=this&&this.__decorate||function(t,e,i,n){var o,a=arguments.length,r=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(r=(a<3?o(r):a>3?o(e,i,r):o(e,i))||r);return a>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(e,"__esModule",{value:!0}),e.QaMattTab=void 0;const o=i(698);let a=class{};a=n([(0,o.PreventIframe)("/qaMattTab/index.html")],a),e.QaMattTab=a},58:t=>{t.exports=require("botbuilder")},883:t=>{t.exports=require("botbuilder-dialogs")},455:t=>{t.exports=require("compression")},974:t=>{t.exports=require("debug")},142:t=>{t.exports=require("dotenv")},860:t=>{t.exports=require("express")},698:t=>{t.exports=require("express-msteams-host")},470:t=>{t.exports=require("morgan")},685:t=>{t.exports=require("http")},17:t=>{t.exports=require("path")},99:t=>{t.exports=JSON.parse('{"$schema":"http://adaptivecards.io/schemas/adaptive-card.json","type":"AdaptiveCard","version":"1.4","body":[{"type":"ColumnSet","columns":[{"type":"Column","width":"auto","items":[{"type":"Image","url":"https://v5j9q4b5.rocketcdn.me/wp-content/uploads/2020/09/bots-o-que-sao-como-funcionam-quais-seus-beneficios-e-maleficios-1024x505.png","size":"Medium"}],"verticalContentAlignment":"Center","spacing":"Large"},{"type":"Column","width":"stretch","items":[{"type":"TextBlock","spacing":"Medium","size":"Large","weight":"Bolder","text":"Bienvenido a QA-Matt","wrap":true,"maxLines":0},{"type":"TextBlock","size":"default","text":"Hola! Esta es una aplicación prueba de QA-Matt 😀","wrap":true,"maxLines":0}]}]},{"type":"ActionSet","actions":[{"type":"Action.OpenUrl","title":"Ejemplo 1","url":"https://newtech.com.ar/"},{"type":"Action.OpenUrl","title":"Ejemplo 2 - Chat GPT","url":"https://newtech.com.ar/aplicaciones-personalizadas/"}],"height":"stretch"},{"type":"ActionSet","actions":[{"type":"Action.Submit","title":"Quien soy?","data":{"msteams":{"type":"messageBack","displayText":"who am i?","text":"who"}}},{"type":"Action.Submit","title":"Mencioname","data":{"msteams":{"type":"messageBack","displayText":"mention me","text":"mention"}}},{"type":"Action.Submit","title":"Obtener Ayuda","data":{"msteams":{"type":"messageBack","displayText":"get help","text":"help"}}}]}]}')}},e={};function i(n){var o=e[n];if(void 0!==o)return o.exports;var a=e[n]={exports:{}};return t[n].call(a.exports,a,a.exports,i),a.exports}(()=>{const t=i(860),e=i(685),n=i(17),o=i(470),a=i(698),r=i(974),s=i(455),c=r("msteams");c("Initializing Microsoft Teams Express hosted App..."),i(142).config();const l=i(64),d=t(),u=process.env.port||process.env.PORT||3007;d.use(t.json({verify:(t,e,i,n)=>{t.rawBody=i.toString()}})),d.use(t.urlencoded({extended:!0})),d.set("views",n.join(__dirname,"/")),d.use(o("tiny")),d.use(s()),d.use("/scripts",t.static(n.join(__dirname,"web/scripts"))),d.use("/assets",t.static(n.join(__dirname,"web/assets"))),d.use((0,a.MsTeamsApiRouter)(l)),d.use((0,a.MsTeamsPageRouter)({root:n.join(__dirname,"web/"),components:l})),d.use("/",t.static(n.join(__dirname,"web/"),{index:"index.html"})),d.set("port",u),e.createServer(d).listen(u,(()=>{c(`Server running on ${u}`)}))})()})();
//# sourceMappingURL=server.js.map